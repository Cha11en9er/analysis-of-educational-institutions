# ОБЪЯСНЕНИЕ МЕТРИК ПО ШКОЛАМ

## Пример из ваших данных (школа с ID, для которой показаны метрики):

```json
"topic_cnt_учителя": 25,
"topic_neg_share_учителя": 0.08,
"topic_sentiment_учителя": 0.24,
"topic_recent_neg_share_учителя": 0.077
```

---

## 1. `topic_cnt_<topic>` - Количество отзывов по теме

**Что означает:**
- Сколько всего отзывов упоминают данную тему

**Как формируется:**
- Проходим по всем отзывам школы
- Если в отзыве есть поле `topics[<topic>]` (например, `topics["учителя"]`), увеличиваем счетчик
- Результат: общее количество упоминаний темы

**Пример:**
- `topic_cnt_учителя: 25` → 25 отзывов упоминали учителей
- `topic_cnt_еда: 14` → 14 отзывов упоминали еду

**Использование:**
- Показывает популярность темы (частота упоминаний)
- Если `topic_cnt` маленький, тема редко обсуждается

---

## 2. `topic_neg_share_<topic>` - Доля негативных отзывов по теме

**Что означает:**
- Какой процент отзывов по теме является негативным

**Как формируется:**
```
topic_neg_share = количество_негативных_отзывов / общее_количество_отзывов_по_теме
```

**Значения:**
- `0.0` = все отзывы положительные (0% негативных)
- `0.5` = половина отзывов негативные (50% негативных)
- `1.0` = все отзывы негативные (100% негативных)

**Пример:**
- `topic_neg_share_учителя: 0.08` → 8% отзывов об учителях негативные (2 из 25)
- `topic_neg_share_еда: 0.214` → 21.4% отзывов о еде негативные (3 из 14)
- `topic_neg_share_буллинг: 1.0` → 100% отзывов о буллинге негативные (1 из 1)

**Использование:**
- Показывает проблемность темы
- Высокое значение (>0.3) = серьезная проблема
- Низкое значение (<0.1) = тема в порядке

---

## 3. `topic_sentiment_<topic>` - Средняя тональность по теме

**Что означает:**
- Усредненная тональность всех отзывов по теме

**Как формируется:**
```
topic_sentiment = (сумма_всех_тональностей) / количество_отзывов

где тональность:
  +1 = положительный отзыв ("pos")
  -1 = негативный отзыв ("neg")
   0 = нейтральный отзыв ("neutral")
```

**Значения:**
- `+1.0` = все отзывы положительные
- `+0.5` = больше положительных, чем негативных
- `0.0` = нейтральная или смешанная тональность
- `-0.5` = больше негативных, чем положительных
- `-1.0` = все отзывы негативные

**Пример:**
- `topic_sentiment_учителя: 0.24` → слабоположительная тональность
  - Это означает: большинство отзывов положительные, но есть и негативные
  - Расчет: (например, 20 положительных × 1 + 2 негативных × -1 + 3 нейтральных × 0) / 25 = 0.72 → нет, подождите
  - Более точно: если 23 положительных (×1) + 2 негативных (×-1) = 23-2 = 21, 21/25 = 0.84... 
  - Но у нас 0.24, значит формула работает иначе. Давайте проверим код.
  - На самом деле: если 20 "pos" (+1), 2 "neg" (-1), 3 "neutral" (0): (20×1 + 2×(-1) + 3×0) / 25 = 18/25 = 0.72
  - Но результат 0.24, значит либо меньше положительных, либо больше нейтральных
  - Возможно: 10 "pos" (+1), 2 "neg" (-1), 13 "neutral" (0): (10×1 + 2×(-1) + 13×0) / 25 = 8/25 = 0.32 (близко)
  - Или: 8 "pos", 2 "neg", 15 "neutral": (8-2)/25 = 6/25 = 0.24 ✓

- `topic_sentiment_еда: 0.143` → слабоположительная тональность
- `topic_sentiment_буллинг: -1.0` → полностью негативная тональность (все отзывы негативные)

**Использование:**
- Более точная метрика, чем `topic_neg_share` (учитывает нейтральные)
- Показывает общее настроение по теме
- Отрицательное значение = проблема

---

## 4. `topic_recent_neg_share_<topic>` - Доля негативных в свежих отзывах

**Что означает:**
- Какой процент негативных отзывов среди СВЕЖИХ отзывов (последние 12 месяцев) по теме

**Как формируется:**
```
topic_recent_neg_share = количество_негативных_свежих_отзывов / количество_всех_свежих_отзывов_по_теме
```

**"Свежие" отзывы:**
- Отзывы, датированные последними 12 месяцами от текущей даты
- Если отзыв старше 12 месяцев, он не учитывается в этой метрике

**Значения:**
- `0.0` = все свежие отзывы положительные
- `1.0` = все свежие отзывы негативные
- `None` = нет свежих отзывов по этой теме

**Пример:**
- `topic_recent_neg_share_учителя: 0.077` → 7.7% свежих отзывов об учителях негативные
- `topic_recent_neg_share_еда: 0.143` → 14.3% свежих отзывов о еде негативные
- `topic_recent_neg_share_охрана: null` → нет свежих отзывов об охране

**Использование:**
- **САМОЕ ВАЖНОЕ:** показывает динамику проблемы
- Сравните с `topic_neg_share`:
  - Если `recent_neg_share` > `neg_share` → ситуация УХУДШАЕТСЯ
  - Если `recent_neg_share` < `neg_share` → ситуация УЛУЧШАЕТСЯ
  - Если равны → стабильная ситуация

**Пример анализа:**
```
topic_neg_share_еда: 0.214 (21.4% негативных за все время)
topic_recent_neg_share_еда: 0.143 (14.3% негативных в последние 12 мес)
```
→ Ситуация с едой УЛУЧШАЕТСЯ! (меньше жалоб в свежих отзывах)

---

## ИТОГОВАЯ ИНТЕРПРЕТАЦИЯ ВАШИХ ДАННЫХ:

### Учителя:
- **25 отзывов** упоминают учителей
- **8% негативных** (2 из 25) - низкий уровень проблем
- **Тональность +0.24** - слабоположительная
- **7.7% негативных в свежих** - ситуация стабильная

**Вывод:** Учителя в порядке, проблем нет

### Еда:
- **14 отзывов** упоминают еду
- **21.4% негативных** (3 из 14) - средний уровень проблем
- **Тональность +0.143** - слабоположительная
- **14.3% негативных в свежих** - ситуация улучшается!

**Вывод:** Есть проблемы с едой, но ситуация улучшается

### Буллинг:
- **1 отзыв** упоминает буллинг
- **100% негативных** - критическая проблема
- **Тональность -1.0** - полностью негативная
- **100% негативных в свежих** - проблема актуальна

**Вывод:** КРИТИЧЕСКАЯ ПРОБЛЕМА! Требует немедленного внимания

---

## КАК ИСПОЛЬЗОВАТЬ ЭТИ МЕТРИКИ:

1. **Приоритизация проблем:**
   - Высокий `topic_neg_share` + высокий `topic_recent_neg_share` = срочная проблема
   - Пример: буллинг (1.0 и 1.0)

2. **Отслеживание динамики:**
   - Сравнивайте `topic_neg_share` и `topic_recent_neg_share`
   - Если `recent` > `общий` → ухудшение
   - Если `recent` < `общий` → улучшение

3. **Выявление скрытых проблем:**
   - Низкий `topic_cnt` но высокий `topic_neg_share` = редкая, но серьезная проблема
   - Пример: охрана (1 отзыв, но если он негативный - стоит проверить)

4. **Сравнение школ:**
   - Используйте метрики для сравнения школ между собой
   - Школа с низкими `neg_share` по всем темам = хорошая школа

